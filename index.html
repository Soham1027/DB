<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Birthday Wish - Dhruvi</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/gsap/3.12.2/gsap.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/canvas-confetti@1.6.0/dist/confetti.browser.min.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=DM+Sans:wght@400;500;700&family=Lora:ital,wght@1,500&display=swap" rel="stylesheet">
    <style>
        body {
            background-color: #f4f1ea; /* Creamy light base */
            color: #4a5d4e; /* Charcoal */
            font-family: 'DM Sans', sans-serif;
            overflow: hidden;
            margin: 0;
            height: 100vh;
            cursor: pointer; /* Hint that user can interact */
        }

        .serif-italic {
            font-family: 'Lora', serif;
            font-style: italic;
            color: #4a5d4e;
        }

        .screen {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            text-align: center;
            padding: 2rem;
            opacity: 0;
            visibility: hidden;
            pointer-events: none; /* Allows click-through to body */
        }

        .divider {
            height: 1px;
            background: #a3b18a;
            width: 40px;
            margin: 2rem 0;
        }

        .btn-sincere {
            border: 1px solid #4a5d4e;
            padding: 0.8rem 2.5rem;
            border-radius: 2px;
            font-size: 0.9rem;
            letter-spacing: 0.05em;
            transition: all 0.4s ease;
            margin-top: 2rem;
            cursor: pointer;
            pointer-events: auto; /* Makes button clickable */
        }
        .btn-sincere:hover {
            background: #4a5d4e;
            color: #f4f1ea;
        }

        .reveal-text {
            transform: translateY(10px);
            opacity: 0;
        }
    </style>
</head>
<body>

    <!-- Audio Element -->
    <audio id="bg-music" loop preload="auto">
        <!-- Main source as specified -->
        <source src="untitled.mp3" type="audio/mpeg">
        <!-- Fallback to handle case sensitivity if needed -->
        <source src="Untitled.mp3" type="audio/mpeg">
    </audio>

    <!-- Step 1: Simple Greeting -->
    <div id="step1" class="screen">
        <h1 class="text-4xl md:text-5xl font-medium tracking-tight">Happy Birthday, Dhruvi</h1>
        <div class="divider"></div>
        <p class="text-lg opacity-60">Hope you're having a good day.</p>
    </div>

    <!-- Step 2: Sincere Appreciation -->
    <div id="step2" class="screen">
        <div class="max-w-md">
            <h2 class="text-3xl serif-italic mb-8">"Glad we're friends."</h2>
            <div class="space-y-4">
                <p class="reveal-text text-xl">You've always been a real one.</p>
                <p class="reveal-text text-xl">Hope things go your way this year.</p>
                <p class="reveal-text text-xl">Keep doing your thing.</p>
            </div>
        </div>
    </div>

    <!-- Step 3: Final Wish -->
    <div id="step3" class="screen">
        <div class="mb-6">
            <span class="text-4xl">ðŸ¥‚</span>
        </div>
        <h2 class="text-5xl font-bold mb-4">Cheers, Dhruvi.</h2>
        <p class="text-xl serif-italic opacity-80">Wishing you a solid year ahead.</p>
        <button onclick="slowConfetti(event)" class="btn-sincere">Celebrate âœ¨</button>
    </div>

    <script>
        const music = document.getElementById('bg-music');

        function slowConfetti(e) {
            if (e) e.stopPropagation();
            const defaults = {
                origin: { y: 0.7 },
                colors: ['#a3b18a', '#4a5d4e', '#dad7cd'],
                shapes: ['circle'],
                gravity: 0.8,
                scalar: 0.7
            };

            confetti({
                ...defaults,
                particleCount: 80,
                spread: 70,
                startVelocity: 30
            });
        }

        // Logic to play music on first interaction (browser requirement)
        const startMusic = () => {
            music.play().then(() => {
                console.log("Music started");
            }).catch(e => {
                console.log("Audio still blocked; waiting for another interaction.");
            });
            // Keep trying to remove listeners on success
            document.removeEventListener('click', startMusic);
            document.removeEventListener('touchstart', startMusic);
            document.removeEventListener('keydown', startMusic);
        };

        // Listen for any interaction to trigger the audio
        document.addEventListener('click', startMusic);
        document.addEventListener('touchstart', startMusic);
        document.addEventListener('keydown', startMusic);

        window.onload = () => {
            const tl = gsap.timeline();

            // Sequence starts automatically on load
            tl.to("#step1", { opacity: 1, visibility: "visible", duration: 1.5 })
              .to("#step1", { opacity: 0, duration: 1, delay: 2.5 })
              
              .to("#step2", { opacity: 1, visibility: "visible", duration: 1 })
              .to(".reveal-text", { 
                opacity: 1, 
                y: 0, 
                stagger: 2, 
                duration: 1.2,
                ease: "power2.out"
              })
              .to("#step2", { opacity: 0, duration: 1, delay: 2 })

              // Triggers automatic confetti pop up on final screen
              .to("#step3", { 
                opacity: 1, 
                visibility: "visible", 
                duration: 1.5,
                onStart: () => {
                    slowConfetti();
                    // One more attempt to play music here if it hasn't started
                    music.play().catch(() => {});
                }
              });
        };
    </script>
</body>
</html>